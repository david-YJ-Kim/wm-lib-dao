<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.miip.mes.pos.domain.mapper.CnPpsSelfInspMapper">
    <select id="selectSelfInspListByAuto" parameterType="hashMap" resultType="com.miip.mes.pos.ivo.brs.lot.BrsPpsSelfInspIVO">
        SELECT
            DECODE(PROD_DEF_ID, 'ALL', 0, 100)+DECODE(PROC_DEF_ID, 'ALL', 0, 10)+DECODE(SELF_INSP_TYP, 'Maint', 9, 0)+DECODE(SELF_INSP_TYP, 'Time', 8, 0)+DECODE(SELF_INSP_TYP, 'Prod', 7, 0)+DECODE(SELF_INSP_TYP, 'Lot', 6, 0) WEIGHT,
            A.PROD_DEF_ID,
            A.PROC_DEF_ID,
            A.PROC_SGMT_ID,
            A.EQP_ID,
            A.LOT_CNT,
            A.SELF_INSP_TYP
        FROM CN_PPS_SELF_INSP A
        WHERE 1=1
          AND SITE_ID = #{siteId}
          AND PROD_DEF_ID = DECODE(A.PROD_DEF_ID, 'ALL', 'ALL', #{prodDefId})
          AND PROC_DEF_ID = DECODE(A.PROC_DEF_ID, 'ALL', 'ALL', #{procDefId})
          AND PROC_SGMT_ID = #{procSgmtId}
          AND EQP_ID = #{eqpId}
          AND USE_STAT_CD = 'Usable'
        ORDER BY 1 DESC
    </select>
</mapper>